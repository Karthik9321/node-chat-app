<!-- <!DOCTYPE html>
<html>

  <head>
    <meta charset = "utf-8">
    <title>Join | ChatApp</title>
    <link rel="icon"
          type="image/jpg"
          href="https://image.freepik.com/free-icon/chat-interface-symbol-with-smiling-face-in-circular-speech-bubble_318-56515.jpg">
    <meta name= "viewport" content = "width=device-width, initial-scale=1, user-scalable=no">
    <link rel = "stylesheet" href ="/css/styles.css">

  </head>

  <body class="centered-form">
    <div class= "centered-form__form">
    <form action = "/chat.html">
      <div class= "form-field">
          <h3>Join a Chat</h3>
      </div>
      <div class= "form-field">
          <label>Display Name</label>
          <input type = "text" name= "name" autofocus/>
      </div>

      <div class= "form-field">
          <label>Room Name</label>
          <input type="text" name="room"/>
      </div>

      <div class= "form-field">

          <button>Join</button>

      </div>
    </form>
    </div>

  </body>


</html> -->
<html>
<body>
  <div id="screen"></div>
  <div id="screen-preview"></div>
  <script src="https://static.opentok.com/v2/js/opentok.min.js"></script>
  <script type="text/javascript">

    // Go to https://tokbox.com/account to find your OpenTok
    // API key and generate a test session ID and token:
    var apiKey    = "46136662";
    var sessionId = "2_MX40NjEzNjY2Mn5-MTUyODc5NTUyMjg0OX5oSTJiWWVjWXpIc2lMMGhza0R1NjFQSFl-fg";
    var token     = "T1==cGFydG5lcl9pZD00NjEzNjY2MiZzaWc9YmEwZTZjODVkZWY4YzA5ZmRkOWFiZWE1MTAzYjhmZGI2OGM0ZDM5MjpzZXNzaW9uX2lkPTJfTVg0ME5qRXpOalkyTW41LU1UVXlPRGM1TlRVeU1qZzBPWDVvU1RKaVdXVmpXWHBJYzJsTU1HaHphMFIxTmpGUVNGbC1mZyZjcmVhdGVfdGltZT0xNTI4Nzk1NTgzJm5vbmNlPTAuNjU5MDQ5ODQ3NjE4MjYxOCZyb2xlPXB1Ymxpc2hlciZleHBpcmVfdGltZT0xNTI4ODgxOTgyJmluaXRpYWxfbGF5b3V0X2NsYXNzX2xpc3Q9";

    var session = OT.initSession(apiKey, sessionId);

    session.connect(token, function(error) {
      var publisher = OT.initPublisher('screen');
      session.publish(publisher, function() {
        screenshare();
      });
    });

    session.on('streamCreated', function(event) {
      session.subscribe(event.stream);
    });

    // For Google Chrome only, register your extension by ID. You can
    // find it at chrome://extensions once the extension is installed.
    //
    // The last parameter assumes you are using the latest version (version 2)
    // of the OpenTok Chrome extension source code.
    OT.registerScreenSharingExtension('chrome', 'lnbggbolddahhghkhgbfkmkhfphfpiji', 2);

    function screenshare() {
      OT.checkScreenSharingCapability(function(response) {
        console.log('resp:: ', response)
        if (!response.supported || response.extensionRegistered === false) {
          alert('This browser does not support screen sharing.');
        } else if (response.extensionInstalled === false) {
          alert('Please install the screen sharing extension and load your app over https.');
        } else {
          // Screen sharing is available. Publish the screen.
          var screenSharingPublisher = OT.initPublisher('screen-preview', {videoSource: 'screen'});
          session.publish(screenSharingPublisher, function(error) {
            if (error) {
              alert('Could not share the screen: ' + error.message);
            }
          });
        }
      });
    }
  </script>
</body>
</html>
